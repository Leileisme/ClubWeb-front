import{p as w,a as I,f as oe,e as H,g as ie,h as B,q as ce,aa as de,o,r as K,t as V,s as A,v as a,ab as M,a9 as j,ac as ue,ad as q,ae as re,af as pe,ag as G,ah as ve,j as J,ai as fe,M as xe,c as me,aj as _e,d as ye,ak as ge,l as Ee,n as Ve,a5 as be,y as Ce,z as Pe,x as ke,R as Se,A as he,B as h,D as Te,H as we,F as l,al as Ie,J as Be,a3 as Ae,a4 as Re,L as D,G as p,Q as T,a8 as $,am as E,Y as U,P as L,O as F,an as ze,ao as De,ap as $e,Z as Le}from"./index-55945f57.js";import{_ as Oe}from"./EventInfo-39139681.js";import{_ as je}from"./_plugin-vue_export-helper-c27b6911.js";import{V as N}from"./VContainer-8bbe5f5a.js";import{V as O,a as d}from"./VRow-c1fb15ad.js";import"./PersonalLine-cdc21d09.js";import"./VDivider-7d9b1768.js";const b=Symbol.for("vuetify:v-expansion-panel"),Ge=["default","accordion","inset","popout"],Ue=w({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>Ge.includes(e)},readonly:Boolean,...I(),...oe(),...H(),...ie()},"VExpansionPanels"),Fe=B()({name:"VExpansionPanels",props:Ue(),emits:{"update:modelValue":e=>!0},setup(e,u){let{slots:n}=u;ce(e,b);const{themeClasses:t}=de(e),i=o(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return K({VExpansionPanel:{color:V(e,"color"),readonly:V(e,"readonly"),static:V(e,"static")}}),A(()=>a(e.tag,{class:["v-expansion-panels",t.value,i.value,e.class],style:e.style},n)),{}}}),Ne=w({...I(),...M()},"VExpansionPanelText"),Q=B()({name:"VExpansionPanelText",props:Ne(),setup(e,u){let{slots:n}=u;const t=j(b);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:i,onAfterLeave:v}=ue(e,t.isSelected);return A(()=>a(pe,{onAfterLeave:v},{default:()=>{var c;return[q(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&i.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(c=n.default)==null?void 0:c.call(n)])]),[[re,t.isSelected.value]])]}})),{}}}),X=w({color:String,expandIcon:{type:G,default:"$expand"},collapseIcon:{type:G,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...I()},"VExpansionPanelTitle"),Y=B()({name:"VExpansionPanelTitle",directives:{Ripple:ve},props:X(),setup(e,u){let{slots:n}=u;const t=j(b);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:i,backgroundColorStyles:v}=J(e,"color"),c=o(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return A(()=>{var x;return q(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value,"v-expansion-panel-title--static":e.static},i.value,e.class],style:[v.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(x=n.default)==null?void 0:x.call(n,c.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(c.value):a(xe,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[fe("ripple"),e.ripple]])}),{}}}),He=w({title:String,text:String,bgColor:String,...I(),...me(),..._e(),...M(),...ye(),...H(),...X()},"VExpansionPanel"),Ke=B()({name:"VExpansionPanel",props:He(),emits:{"group:selected":e=>!0},setup(e,u){let{slots:n}=u;const t=ge(e,b),{backgroundColorClasses:i,backgroundColorStyles:v}=J(e,"bgColor"),{elevationClasses:c}=Ee(e),{roundedClasses:x}=Ve(e),C=o(()=>(t==null?void 0:t.disabled.value)||e.disabled),m=o(()=>t.group.items.value.reduce((r,s,y)=>(t.group.selected.value.includes(s.id)&&r.push(y),r),[])),_=o(()=>{const r=t.group.items.value.findIndex(s=>s.id===t.id);return!t.isSelected.value&&m.value.some(s=>s-r===1)}),R=o(()=>{const r=t.group.items.value.findIndex(s=>s.id===t.id);return!t.isSelected.value&&m.value.some(s=>s-r===-1)});return be(b,t),K({VExpansionPanelText:{eager:V(e,"eager")},VExpansionPanelTitle:{readonly:V(e,"readonly")}}),A(()=>{const r=!!(n.text||e.text),s=!!(n.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":_.value,"v-expansion-panel--after-active":R.value,"v-expansion-panel--disabled":C.value},x.value,i.value,e.class],style:[v.value,e.style]},{default:()=>{var y;return[a("div",{class:["v-expansion-panel__shadow",...c.value]},null),s&&a(Y,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),r&&a(Q,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(y=n.default)==null?void 0:y.call(n)]}})}),{}}});const Me={class:"me-4",style:{"font-size":"1.5rem"}},qe={__name:"EventTicketView",setup(e){const u=Ce(),n=Pe(),t=j("routeEvent"),i=ke(),{apiAuth:v}=Le(),c=Se(),{xs:x}=he(),C=o(()=>x.value),m=h(0),_=h(!0),R=o(()=>C.value?3:2),r=o(()=>C.value?"margin-bottom:5px;":"margin-bottom:15px;"),s=o(()=>_.value?"mdi-plus":"mdi-minus"),y=()=>{_.value=!_.value,m.value=_.value?0:1},P=h(!1),Z=()=>{P.value=!P.value},W=o(()=>P.value?"less":"more"),ee=o(()=>P.value?"color: #aaa;":" color:#FF3333;"),ae=o(()=>m.value===0),k=h(!1),te=()=>{k.value=!1,u.push(`/event/${n.params.id}`)},le=async()=>{var z,g;if(i.SCORES<t.SCORE_VALUES)c({text:"積分不足",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});else try{const S=(await v.get(`/events/${n.params.id}`)).data.result.TICKET;if(console.log(S),S.some(se=>se.USER===i._id)){k.value=!0;return}const ne=[{USER:i._id,USED:!1}];await v.patch(`/events/${n.params.id}`,{TICKET:ne}),c({text:"取票成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),u.push(`/event/${n.params.id}`)}catch(f){console.log(f);const S=((g=(z=f==null?void 0:f.response)==null?void 0:z.data)==null?void 0:g.message)||"發生錯誤，請稍後再試";c({text:S,showCloseButton:!1,snackbarProps:{timeout:2e3,console:"red",location:"bottom"}})}};return(z,g)=>(Te(),we(Be,null,[a(N,{style:{padding:"0","max-width":"800px"}},{default:l(()=>[a(N,null,{default:l(()=>[a(O,null,{default:l(()=>[a(d,{cols:R.value,class:"d-flex justify-center",style:{"background-color":""}},{default:l(()=>[a(Ae,{size:"96%"},{default:l(()=>[a(Re,{src:D(t).HOST.IMAGE},null,8,["src"])]),_:1})]),_:1},8,["cols"]),a(d,{cols:"9",style:{"font-size":"1.5rem","font-weight":"900"},class:"d-flex align-center"},{default:l(()=>[p(T(D(t).TITLE),1)]),_:1}),a(Oe),a(d,{cols:"12"},{default:l(()=>[a($,{class:"rounded-lg"},{default:l(()=>[a(E,{style:{color:"#25ECE0","padding-bottom":"0"}},{default:l(()=>[p("購票須知")]),_:1}),a(E,null,{default:l(()=>[p("此票券只限本人使用，活動當天請攜帶本票券，供主辦單位掃描入場。若取票後無故未使用，會影響個人「名譽」。當日刷票後即會將活動紀錄於「個人檔案」，即可PO當日活動文。")]),_:1})]),_:1})]),_:1}),a(d,{cols:"12"},{default:l(()=>[a($,{class:"rounded-lg"},{default:l(()=>[a(O,null,{default:l(()=>[a(d,{cols:"8",style:{"padding-bottom":"0"}},{default:l(()=>[a(E,{style:{color:"#25ECE0","padding-bottom":"0"}},{default:l(()=>[p("單人票")]),_:1}),a(E,{style:{"font-size":"1.6rem"}},{default:l(()=>[p("免費票")]),_:1})]),_:1}),a(d,{cols:"3",class:"d-flex align-center",style:{"padding-bottom":"0"}},{default:l(()=>[U("div",Me,T(m.value),1),a(L,{density:"compact",size:"large",icon:s.value,color:"#25ECE0",onClick:y},null,8,["icon"])]),_:1}),a(d,{cols:"12",style:{"padding-top":"0"}},{default:l(()=>[a(Fe,null,{default:l(()=>[a(Ke,{onClick:Z},{default:l(()=>[a(Y,{"expand-icon":"mdi-menu-down"},{default:l(()=>[U("span",{style:F([ee.value,{"font-weight":"bolder","font-size":"1.1rem"}])},T(W.value),5)]),_:1}),a(Q,null,{default:l(()=>[a(O,{style:{"padding-top":"5px"}},{default:l(()=>[a(d,{cols:"12",style:{color:"#25ECE0","font-size":"0.9rem","font-weight":"bold","padding-bottom":"0px"}},{default:l(()=>[p("活動介紹")]),_:1}),a(d,{cols:"12"},{default:l(()=>[p(T(D(t).DESCRIPTION),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(d,{cols:"12",class:"d-flex justify-end"},{default:l(()=>[a(L,{color:"#1BBCA9",class:"okBtn",style:{"font-weight":"900"},onClick:le,disabled:ae.value},{default:l(()=>[p("確定取票")]),_:1},8,["disabled"])]),_:1}),a(d,{style:F(r.value)},null,8,["style"])]),_:1})]),_:1})]),_:1}),a(Ie,{modelValue:k.value,"onUpdate:modelValue":g[0]||(g[0]=f=>k.value=f),"max-width":"290"},{default:l(()=>[a($,{class:"rounded-lg"},{default:l(()=>[a(ze),a(E,{class:"headline text-center",style:{"font-size":"1.2rem"}},{default:l(()=>[p("已取過票溜!")]),_:1}),a(De,null,{default:l(()=>[a($e),a(L,{color:"#1BBCA9",style:{"font-weight":"900"},onClose:te},{default:l(()=>[p("關閉")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},aa=je(qe,[["__scopeId","data-v-a6e53859"]]);export{aa as default};
