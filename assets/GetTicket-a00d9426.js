import{p as R,a as B,f as pe,e as Y,g as xe,h as U,q as me,aa as Ie,o as d,r as Z,t as _,s as z,v as a,ab as W,a9 as K,ac as Te,ad as ee,ae as ye,af as Ee,ag as H,ah as Se,j as ae,ai as ge,M as _e,c as Ce,aj as Ve,d as he,ak as ke,l as be,n as Pe,a3 as we,y as Ae,z as Re,x as Be,A as Ue,B as u,D as ze,H as Oe,F as n,J as De,a6 as Ne,a7 as Le,L as $,G as I,Q as w,a8 as M,al as A,Y as q,P as J,O as Q,Z as $e}from"./index-64fe88be.js";import{_ as g,a as Ge}from"./InfoAll-858b8683.js";import{V as X}from"./VContainer-fec5554a.js";import{V as G}from"./VRow-af87a27a.js";import{V as r}from"./VCol-4c7e89b7.js";import"./BlankLine-021ecd90.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VDivider-88d46b33.js";const C=Symbol.for("vuetify:v-expansion-panel"),Ke=["default","accordion","inset","popout"],je=R({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>Ke.includes(e)},readonly:Boolean,...B(),...pe(),...Y(),...xe()},"VExpansionPanels"),Fe=U()({name:"VExpansionPanels",props:je(),emits:{"update:modelValue":e=>!0},setup(e,v){let{slots:l}=v;me(e,C);const{themeClasses:t}=Ie(e),o=d(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Z({VExpansionPanel:{color:_(e,"color"),readonly:_(e,"readonly"),static:_(e,"static")}}),z(()=>a(e.tag,{class:["v-expansion-panels",t.value,o.value,e.class],style:e.style},l)),{}}}),He=R({...B(),...W()},"VExpansionPanelText"),te=U()({name:"VExpansionPanelText",props:He(),setup(e,v){let{slots:l}=v;const t=K(C);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:o,onAfterLeave:m}=Te(e,t.isSelected);return z(()=>a(Ee,{onAfterLeave:m},{default:()=>{var p;return[ee(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[l.default&&o.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(p=l.default)==null?void 0:p.call(l)])]),[[ye,t.isSelected.value]])]}})),{}}}),ne=R({color:String,expandIcon:{type:H,default:"$expand"},collapseIcon:{type:H,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...B()},"VExpansionPanelTitle"),le=U()({name:"VExpansionPanelTitle",directives:{Ripple:Se},props:ne(),setup(e,v){let{slots:l}=v;const t=K(C);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:o,backgroundColorStyles:m}=ae(e,"color"),p=d(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return z(()=>{var T;return ee(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value,"v-expansion-panel-title--static":e.static},o.value,e.class],style:[m.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(T=l.default)==null?void 0:T.call(l,p.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[l.actions?l.actions(p.value):a(_e,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[ge("ripple"),e.ripple]])}),{}}}),Me=R({title:String,text:String,bgColor:String,...B(),...Ce(),...Ve(),...W(),...he(),...Y(),...ne()},"VExpansionPanel"),qe=U()({name:"VExpansionPanel",props:Me(),emits:{"group:selected":e=>!0},setup(e,v){let{slots:l}=v;const t=ke(e,C),{backgroundColorClasses:o,backgroundColorStyles:m}=ae(e,"bgColor"),{elevationClasses:p}=be(e),{roundedClasses:T}=Pe(e),E=d(()=>(t==null?void 0:t.disabled.value)||e.disabled),y=d(()=>t.group.items.value.reduce((f,i,x)=>(t.group.selected.value.includes(i.id)&&f.push(x),f),[])),O=d(()=>{const f=t.group.items.value.findIndex(i=>i.id===t.id);return!t.isSelected.value&&y.value.some(i=>i-f===1)}),D=d(()=>{const f=t.group.items.value.findIndex(i=>i.id===t.id);return!t.isSelected.value&&y.value.some(i=>i-f===-1)});return we(C,t),Z({VExpansionPanelText:{eager:_(e,"eager")},VExpansionPanelTitle:{readonly:_(e,"readonly")}}),z(()=>{const f=!!(l.text||e.text),i=!!(l.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":O.value,"v-expansion-panel--after-active":D.value,"v-expansion-panel--disabled":E.value},T.value,o.value,e.class],style:[m.value,e.style]},{default:()=>{var x;return[a("div",{class:["v-expansion-panel__shadow",...p.value]},null),i&&a(le,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[l.title?l.title():e.title]}),f&&a(te,{key:"text"},{default:()=>[l.text?l.text():e.text]}),(x=l.default)==null?void 0:x.call(l)]}})}),{}}}),Je={class:"me-4",style:{"font-size":"1.5rem"}},na={__name:"GetTicket",setup(e){const v=Ae(),l=Re(),t=K("routeEvent"),o=Be(),{apiAuth:m}=$e(),{xs:p}=Ue(),T=d(()=>p.value),E=u(0),y=u(!0),O=d(()=>T.value?3:2),D=d(()=>T.value?"margin-bottom:5px;":"margin-bottom:15px;"),f=d(()=>y.value?"mdi-plus":"mdi-minus"),i=()=>{y.value=!y.value,E.value=y.value?0:1},x=u(!1),se=()=>{x.value=!x.value},oe=d(()=>x.value?"less":"more"),ie=d(()=>x.value?"color: #aaa;":" color:#FF3333;"),ce=d(()=>E.value===0),V=u(!1),ue=u("已經取過票溜！"),N=u(!1),j=u("Sorry！榮譽積分不足～快參加活動賺積分(-`д´-)"),h=u(!1),de=u("ㄚ！晚了一步，預售票沒有啦～"),k=u(!1),F=u(""),b=u(!1),re=u("取票成功！"),S=()=>{V.value=!1,N.value=!1,k.value=!1,h.value=!1,b.value=!1,v.push(`/event/${l.params.id}`)},fe=async()=>{var L,c;if(t.value.HOST._id===o._id){console.log("這邊要跳出 取票狀態表單");return}if(o.SCORES<t.value.SCORE_VALUES)N.value=!0;else if(t.value.PRE_SALE-t.value.TICKET.length===0)h.value=!0;else if(t.value.TICKET.some(s=>s.USER===o._id))V.value=!0;else try{const s=[{USER:o._id,USED:!1}],P=await m.patch(`/events/${l.params.id}`,{TICKET:s});console.log(P);const ve=P.data.ticketId;o.TICKET_CART.push({EVENT:l.params.id,TICKET:ve}),await m.patch("/users/edit",{USER_NAME:o.USER_NAME,TICKET_CART:o.TICKET_CART}),b.value=!0}catch(s){console.log(s);const P=((c=(L=s==null?void 0:s.response)==null?void 0:L.data)==null?void 0:c.message)||"發生錯誤，請稍後再試";F.value=P,k.value=!0}};return(L,c)=>(ze(),Oe(De,null,[a(X,{style:{padding:"0","max-width":"800px"}},{default:n(()=>[a(X,null,{default:n(()=>[a(G,null,{default:n(()=>[a(r,{cols:O.value,class:"d-flex justify-center",style:{"background-color":""}},{default:n(()=>[a(Ne,{size:"96%"},{default:n(()=>[a(Le,{src:$(t).HOST.IMAGE},null,8,["src"])]),_:1})]),_:1},8,["cols"]),a(r,{cols:"9",style:{"font-size":"1.5rem","font-weight":"900"},class:"d-flex align-center"},{default:n(()=>[I(w($(t).TITLE),1)]),_:1}),a(Ge),a(r,{cols:"12"},{default:n(()=>[a(M,{class:"rounded-lg"},{default:n(()=>[a(A,{style:{color:"#25ECE0","padding-bottom":"0"}},{default:n(()=>[I("購票須知")]),_:1}),a(A,null,{default:n(()=>[I("此票券只限本人使用，活動當天請攜帶本票券，供主辦單位掃描入場。若取票後無故未使用，會影響個人「名譽」。當日刷票後即會將活動紀錄於「個人檔案」，即可PO當日活動文。")]),_:1})]),_:1})]),_:1}),a(r,{cols:"12"},{default:n(()=>[a(M,{class:"rounded-lg"},{default:n(()=>[a(G,null,{default:n(()=>[a(r,{cols:"8",style:{"padding-bottom":"0"}},{default:n(()=>[a(A,{style:{color:"#25ECE0","padding-bottom":"0"}},{default:n(()=>[I("單人票")]),_:1}),a(A,{style:{"font-size":"1.6rem"}},{default:n(()=>[I("免費票")]),_:1})]),_:1}),a(r,{cols:"3",class:"d-flex align-center",style:{"padding-bottom":"0"}},{default:n(()=>[q("div",Je,w(E.value),1),a(J,{density:"compact",size:"large",icon:f.value,color:"#25ECE0",onClick:i},null,8,["icon"])]),_:1}),a(r,{cols:"12",style:{"padding-top":"0"}},{default:n(()=>[a(Fe,null,{default:n(()=>[a(qe,{onClick:se},{default:n(()=>[a(le,{"expand-icon":"mdi-menu-down"},{default:n(()=>[q("span",{style:Q([ie.value,{"font-weight":"bolder","font-size":"1.1rem"}])},w(oe.value),5)]),_:1}),a(te,null,{default:n(()=>[a(G,{style:{"padding-top":"5px"}},{default:n(()=>[a(r,{cols:"12",style:{color:"#25ECE0","font-size":"0.9rem","font-weight":"bold","padding-bottom":"0px"}},{default:n(()=>[I("活動介紹")]),_:1}),a(r,{cols:"12"},{default:n(()=>[I(w($(t).DESCRIPTION),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(r,{cols:"12",class:"d-flex justify-end"},{default:n(()=>[a(J,{color:"#1BBCA9",class:"okBtn",style:{"font-weight":"900"},onClick:fe,disabled:ce.value},{default:n(()=>[I("確定取票")]),_:1},8,["disabled"])]),_:1}),a(r,{style:Q(D.value)},null,8,["style"])]),_:1})]),_:1})]),_:1}),a(g,{InfoSwitch:N.value,InfoText:j.value,closeInfo:S,"onUpdate:InfoSwitch":c[0]||(c[0]=s=>j.value=s)},null,8,["InfoSwitch","InfoText"]),a(g,{InfoSwitch:V.value,InfoText:ue.value,closeInfo:S,"onUpdate:InfoSwitch":c[1]||(c[1]=s=>V.value=s)},null,8,["InfoSwitch","InfoText"]),a(g,{InfoSwitch:h.value,InfoText:de.value,closeInfo:S,"onUpdate:InfoSwitch":c[2]||(c[2]=s=>h.value=s)},null,8,["InfoSwitch","InfoText"]),a(g,{InfoSwitch:k.value,InfoText:F.value,closeInfo:S,"onUpdate:InfoSwitch":c[3]||(c[3]=s=>k.value=s)},null,8,["InfoSwitch","InfoText"]),a(g,{InfoSwitch:b.value,InfoText:re.value,closeInfo:S,"onUpdate:InfoSwitch":c[4]||(c[4]=s=>b.value=s)},null,8,["InfoSwitch","InfoText"])],64))}};export{na as default};
